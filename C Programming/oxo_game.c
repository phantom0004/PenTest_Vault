#include <stdio.h>
#include <stdlib.h>

void showDefaultTable();
void showCurrentTable(int oxo_table[3][3]);
void playGame(int oxo_table[3][3]);
int checkWinner(int oxo_table[3][3], int player);

int main(){
    int oxo_table[3][3] = {
        {-1, -1, -1},
        {-1, -1, -1},
        {-1, -1, -1}
    };

    playGame(oxo_table);

    return 0;
}

void showDefaultTable(){
    printf("DEFAULT TABLE TO REFER TO : \n");
    int number_table = 1;
    for(int row = 0; row < 3; row ++){
        for(int column = 0; column < 3; column++){
            printf("|\t%d\t|", number_table);
            number_table++;
        }
        printf("\n");
    }
}

void showCurrentTable(int oxo_table[3][3]){
    printf("CURRENT OXO TABLE : \n");
    for(int row = 0; row < 3; row ++){
        for(int column = 0; column < 3; column++){
            switch(oxo_table[row][column]){
                case 1:
                    printf("|\tX\t|");
                    break;
                case 0:
                    printf("|\t0\t|");
                    break;
                default:
                    printf("|\t \t|");
            }
        }
        printf("\n");
    }
}

void playGame(int oxo_table[3][3]){
    int current_player = 1, table_counter = 0, user_input = 0, table_change_flag = 0;

    while(1){
        system("cls");

        table_change_flag = 0;

        if(table_counter == 9){
            showCurrentTable(oxo_table);
            printf("Game resulted in a draw! \n");

            return;
        }

        showDefaultTable();
        printf("\n\n");
        showCurrentTable(oxo_table);
        printf("\n\n");

        printf("PLAYER %d IS PLAYING : \n", current_player);
        printf("Enter a number from the table (1-9) : ");
        scanf("%d", &user_input);

        int counter = 0;
        for (int row = 0; row < 3; row++) {
            for (int column = 0; column < 3; column++) {
                counter++;
                if (counter == user_input) {
                    if (oxo_table[row][column] == -1) {
                        oxo_table[row][column] = current_player % 2;
                        table_change_flag = 1;

                        break;
                    }
                }
            }
            if (table_change_flag) break; 
        }

        if(table_change_flag == 1){
            if(checkWinner(oxo_table, current_player % 2) != -1){
                system("cls");
                showCurrentTable(oxo_table);
                
                printf("PLAYER %d HAS WON THE GAME!", current_player);

                return;
            }else{
                current_player = (current_player % 2) ? 2 : 1; //Switch player
                table_counter++;
            }
        }
    }
}

int checkWinner(int oxo_table[3][3], int player){
    if( (player == oxo_table[0][0] && player == oxo_table[0][1] && player == oxo_table[0][2]) || //Check for first row
        (player == oxo_table[1][0] && player == oxo_table[1][1] && player == oxo_table[1][2]) || //Check for second row
        (player == oxo_table[2][0] && player == oxo_table[2][1] && player == oxo_table[2][2]) || //Check for third row
        (player == oxo_table[0][0] && player == oxo_table[1][0] && player == oxo_table[2][0]) || //Check for first column
        (player == oxo_table[0][1] && player == oxo_table[1][1] && player == oxo_table[2][1]) || //Check for second column
        (player == oxo_table[0][2] && player == oxo_table[1][2] && player == oxo_table[2][2]) || //Check for third column
        (player == oxo_table[0][0] && player == oxo_table[1][1] && player == oxo_table[2][2]) || //Check for first diagonal
        (player == oxo_table[0][2] && player == oxo_table[1][1] && player == oxo_table[2][0]) )  //Check for second diagonal
        {
            return player;
        }else{
            return -1;
        }
}
